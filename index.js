(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o["dom-reactive"]={}))})(this,function(o){"use strict";function l(n){return{all:n=n||new Map,on:function(e,t){var s=n.get(e);s?s.push(t):n.set(e,[t])},off:function(e,t){var s=n.get(e);s&&(t?s.splice(s.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var s=n.get(e);s&&s.slice().map(function(a){a(t)}),(s=n.get("*"))&&s.slice().map(function(a){a(e,t)})}}}const p=l();let y=new Map;function g(n,e){const t=document.getElementById(n);if(t){const s=e();S(t,s),window[n]=s}else throw Error("Нет wrapper: #"+n)}function A(n){const e=`state_${crypto.randomUUID()}`,t=new Proxy({value:n},{set(s,a,c){return a==="value"?(s[a]=c,p.emit(e,s),!0):!1}});return y.set(t,e),p.emit(e,t),t}function S(n,e){n.querySelectorAll("[data-class]").forEach(a=>{if(a.dataset.class){let c=a.dataset.class;a.removeAttribute("data-class");const i=JSON.parse(c);if(Array.isArray(i))for(let r in i){let f=i[r];const d=/(.+?)\s*\?\s*(.+?)\s*:\s*(.+)/,u=f.match(d);let m=u[1];const b=u[2],j=u[3];s(a,[b,j],m)}else if(h(i))for(let r in i){let f=i[r];s(a,r,f)}}});function s(a,c,i){let r=!1;i[0]==="!"&&(r=!0,i=i.slice(1));let f=i.replace(/^\w+\./,"");const d=e[f];v(d,c,a,r);let u=y.get(d);p.on(u,m=>{v(m,c,a,r)})}}function v(n,e,t,s=!1){n.value&&!s?Array.isArray(e)?(t.classList.remove(e[1]),t.classList.add(e[0])):t.classList.add(e):Array.isArray(e)?(t.classList.remove(e[0]),t.classList.add(e[1])):t.classList.remove(e)}function h(n){return n!==null&&typeof n=="object"}o.createScope=g,o.ref=A,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.js.map
